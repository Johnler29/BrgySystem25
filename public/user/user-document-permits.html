<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Request Documents ‚Äî Barangay Langkaan II</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="/base.css">
  <style>
    body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    
    /* Info Banner */
    .info-banner {
      background: #1a237e;
      color: #fff;
      padding: 16px 20px;
      border-radius: 10px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,.1);
    }
    .info-banner-content {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    .info-banner-icon {
      font-size: 1.25rem;
      margin-top: 2px;
    }
    .info-banner-title {
      font-weight: 600;
      display: block;
      margin-bottom: 4px;
    }
    .info-banner-text {
      font-size: 0.875rem;
      margin: 0;
      line-height: 1.5;
      opacity: 0.95;
    }
    
    /* Action Bar */
    .action-bar {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 24px;
    }
    @media (min-width: 640px) {
      .action-bar {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
    }
    .search-wrapper {
      position: relative;
      width: 100%;
    }
    @media (min-width: 640px) {
      .search-wrapper {
        width: auto;
        min-width: 320px;
      }
    }
    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #9ca3af;
      pointer-events: none;
    }
    .search-input {
      width: 100%;
      padding: 12px 16px 12px 44px;
      background: #fff;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      font-size: 0.875rem;
      transition: all 0.2s ease;
    }
    .search-input:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52,152,219,.1);
    }
    .search-input:hover {
      box-shadow: 0 2px 4px rgba(0,0,0,.05);
    }
    .search-input::placeholder {
      color: #9ca3af;
    }
    
    /* Table */
    .table-card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,.04);
      border: 1px solid #e5e7eb;
      overflow: hidden;
    }
    .table-user-docs {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }
    .table-user-docs thead {
      background: #f8f9fa;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .table-user-docs thead th {
      padding: 14px 24px;
      text-align: left;
      font-size: 0.75rem;
      font-weight: 700;
      color: #374151;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 2px solid #e5e7eb;
      white-space: nowrap;
    }
    .table-user-docs tbody tr {
      transition: all 0.2s ease;
      background: #fff;
      border-bottom: 1px solid #f1f3f5;
    }
    .table-user-docs tbody tr:nth-child(even) {
      background: #fafbfc;
    }
    .table-user-docs tbody tr:hover {
      background: #f0f7ff;
      box-shadow: 0 1px 3px rgba(52,152,219,.08);
    }
    .table-user-docs tbody td {
      padding: 14px 24px;
      font-size: 0.875rem;
      color: #374151;
      vertical-align: middle;
    }
    
    /* Badges */
    .badge {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 700;
      display: inline-block;
    }
    .badge-pending { background: #fff4e5; color: #b9770e; }
    .badge-processing { background: #eaf4ff; color: #1b73c7; }
    .badge-ready { background: #e9f9ef; color: #239b56; }
    .badge-released { background: #e9f9ef; color: #239b56; }
    
    /* Modal */
    .modal-user {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.45);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 1000;
      overflow-y: auto;
    }
    .modal-user.active {
      display: flex;
    }
    .modal-content-user {
      width: 100%;
      max-width: 700px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,.2);
      overflow: hidden;
      border: 1px solid #e5e7eb;
      margin: 20px 0;
    }
    .modal-header-user {
      padding: 16px 20px;
      background: #f8f9fa;
      border-bottom: 1px solid #e5e7eb;
      font-weight: 600;
      font-size: 1.125rem;
      color: #2c3e50;
    }
    .modal-body-user {
      padding: 20px;
      max-height: calc(100vh - 180px);
      overflow-y: auto;
    }
    .modal-footer-user {
      padding: 16px 20px;
      background: #f8f9fa;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    .form-grid-user {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }
    .form-grid-user .full {
      grid-column: 1 / -1;
    }
    .form-field-user label {
      display: block;
      color: #7f8c8d;
      margin-bottom: 6px;
      font-size: 0.875rem;
      font-weight: 500;
    }
    .form-field-user input,
    .form-field-user select,
    .form-field-user textarea {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #dfe6e9;
      border-radius: 8px;
      background: #fff;
      font-size: 0.875rem;
      font-family: inherit;
      transition: all 0.2s ease;
    }
    .form-field-user input:focus,
    .form-field-user select:focus,
    .form-field-user textarea:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52,152,219,.1);
    }
    .form-field-user input[readonly] {
      background: #f3f4f6;
      color: #6b7280;
      cursor: not-allowed;
    }
    .form-field-user small {
      color: #7f8c8d;
      font-size: 0.75rem;
      margin-top: 4px;
      display: block;
    }
    .resident-dropdown {
      position: absolute;
      z-index: 50;
      width: 100%;
      margin-top: 4px;
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,.1);
      max-height: 240px;
      overflow-y: auto;
      display: none;
    }
    .resident-dropdown.active {
      display: block;
    }
    .resident-option {
      padding: 10px 12px;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .resident-option:hover {
      background: #f0f7ff;
    }
    
    /* Buttons */
    .btn-primary-user {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border-radius: 12px;
      background: #3498db;
      color: #fff;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      border: none;
      transition: all 0.2s ease;
      box-shadow: 0 2px 4px rgba(52,152,219,.2);
    }
    .btn-primary-user:hover {
      background: #2980b9;
      box-shadow: 0 4px 8px rgba(52,152,219,.3);
      transform: translateY(-1px);
    }
    .btn-secondary-user {
      padding: 10px 18px;
      border-radius: 8px;
      border: 1.5px solid #d1d5db;
      background: #ecf0f1;
      color: #2c3e50;
      font-weight: 500;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn-secondary-user:hover {
      opacity: 0.9;
    }
    
    /* Table Action Buttons - Standardized across all user pages */
    .action-btn-view {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 0.8125rem;
      font-weight: 600;
      border: 1.5px solid #d1d5db;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #fff;
      color: #374151;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: inherit;
    }
    .action-btn-view:hover {
      background: #3498db;
      color: #fff;
      border-color: #3498db;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(52,152,219,.2);
    }
    .action-btn-view:active {
      transform: translateY(0);
    }
    .action-btn-view i {
      font-size: 0.75rem;
    }
    .table-user-docs .action-btn-view {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 0.8125rem;
      font-weight: 600;
      border: 1.5px solid #d1d5db;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #fff;
      color: #374151;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: inherit;
    }
    .table-user-docs .action-btn-view:hover {
      background: #3498db;
      color: #fff;
      border-color: #3498db;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(52,152,219,.2);
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .form-grid-user {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<script defer src="/base-header.js"></script>
<script defer src="/base.js"></script>

<body class="font-inter">
<div class="dashboard-container">
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <img src="https://scontent.fmnl31-1.fna.fbcdn.net/v/t1.15752-9/566459805_2304695176635817_7965723576219961744_n.png?_nc_cat=100&ccb=1-7&_nc_sid=9f807c&_nc_eui2=AeFvsvFPtYKGEdwHZwyXJu6hLWJQAEjhjVotYlAASOGNWmCLSn6KIuOYN8ElKlNNHQrO159FSCuwFcll7OgdlzCP&_nc_ohc=yiA3bhEGnNAQ7kNvwGUy1mZ&_nc_oc=AdkuAJIw6rTtWuKWDNP7QJAFplSOwMhvUK5rJ7b_uZdCToSR1sT73c7CFJ5zrYhIU-I&_nc_zt=23&_nc_ht=scontent.fmnl31-1.fna&oh=03_Q7cD3gGocOn0qEMEx3iINh9aOx48m0LIlXIab9IT08mckx_JZw&oe=692126F5" alt="Logo">
      <h3 class="sidebar-title">Barangay Langkaan II<br><small style="font-size:0.85em;opacity:0.8;">Resident Portal</small></h3>
    </div>

    <ul class="sidebar-menu" id="navList">
      <li><a href="/user/dashboard" data-tooltip="Dashboard"><span class="icon">üè†Ô∏é</span><span class="label">Dashboard</span></a></li>
      <li><a href="/user/document-permits" class="active" data-tooltip="Request Documents"><span class="icon">üìÑ</span><span class="label">Request Documents</span></a></li>
      <li><a href="/user/community" data-tooltip="Community"><span class="icon">ü§ù</span><span class="label">Community</span></a></li>
      <li><a href="/user/cases" data-tooltip="Report Cases"><span class="icon">‚öñÔ∏è</span><span class="label">Report Cases</span></a></li>
      <li><a href="/user/health" data-tooltip="Health Services"><span class="icon">üè•</span><span class="label">Health Services</span></a></li>
      <li><a href="/user/disaster" data-tooltip="Disaster Info"><span class="icon">üö®</span><span class="label">Disaster Info</span></a></li>

      <li style="margin-top:50px;"><a href="/user/settings" data-tooltip="Settings"><span class="icon">‚öôÔ∏è</span><span class="label">Settings</span></a></li>
      <li><a href="#" onclick="fetch('/api/logout',{method:'POST'}).then(()=>location.href='/login')" data-tooltip="Log out"><span class="icon">üö™</span><span class="label">Log out</span></a></li>
    </ul>
  </nav>

  <main class="main-content">
    <header class="header">
      <div class="header-left">
        <button class="hamburger" id="hamburgerBtn" aria-label="Toggle sidebar"><span></span></button>
        <h1 class="app-title">Request Documents</h1>
      </div>
      <div class="user-info" id="userChip">
        <button class="btn btn-outline" id="notifBtn" title="Notifications">üîî</button>
        <div class="user-avatar" id="avatar">U</div>
        <span id="username" class="user-name">User</span>

        <div class="notif-panel" id="notifPanel">
          <div class="notif-head">Notifications</div>
          <div class="notif-item">No new notifications.</div>
        </div>

        <div class="dropdown" id="userMenu">
          <div class="item" id="goProfile">üë§ Profile</div>
          <div class="item" id="goSettings">‚öôÔ∏è Settings</div>
          <div class="item" id="doLogout">üö™ Log out</div>
        </div>
      </div>
    </header>

    <div class="content-area">
      <!-- Info Banner -->
      <div class="info-banner">
        <div class="info-banner-content">
          <div class="info-banner-icon">‚ÑπÔ∏è</div>
          <div>
            <strong class="info-banner-title">Resident Portal</strong>
            <p class="info-banner-text">View and request your documents here. Only your requests are visible.</p>
          </div>
        </div>
      </div>

      <!-- Action Bar -->
      <div class="action-bar">
        <button class="btn-primary-user" id="addNewBtn">
          <span style="font-size: 1.125rem;">+</span>
          <span>Request New Document</span>
        </button>
        <div class="search-wrapper">
          <div class="search-icon">
            <i class="fas fa-search"></i>
          </div>
          <input id="searchInput" type="text" placeholder="Search by type, purpose..." class="search-input">
        </div>
      </div>

      <!-- Table Card -->
      <div class="table-card">
        <div style="overflow-x: auto;">
          <table class="table-user-docs" id="docsTable">
            <thead>
              <tr>
                <th>Type of Document</th>
                <th>Number of Copies</th>
                <th>Date Requested</th>
                <th>Date Released</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="reqTbody">
              <!-- rows injected by user-document-permits.js -->
            </tbody>
          </table>
        </div>
      </div>

      <div class="pager-user" id="pager" style="display:none; margin-top: 24px;"></div>
    </div>
  </main>
</div>

<!-- Add/Edit Modal -->
<div class="modal-user" id="formModal" aria-hidden="true">
  <div class="modal-content-user">
    <header class="modal-header-user" id="formTitle">Request New Document</header>
    <div class="modal-body-user">
      <div style="color: #7f8c8d; margin-bottom: 10px;" id="msg"></div>
      <form id="docForm" novalidate>
        <div class="form-grid-user">
          <div class="form-field-user">
            <label>Type of Document *</label>
            <select id="typeOfDocument" required>
              <option value="">Select Document Type</option>
              <option>Barangay Clearance</option>
              <option>Certificate of Indigency</option>
              <option>Certificate of Residency</option>
              <option>Barangay ID</option>
              <option>Construction Permit</option>
            </select>
          </div>
          <div class="form-field-user">
            <label>Number of Copies *</label>
            <input id="numberOfCopies" type="number" min="1" value="1" required>
          </div>
          <div class="form-field-user">
            <label>Your Name *</label>
            <input id="requesterName" type="text" required>
            <small id="nameHelp">Auto-filled from your account (you can edit if needed)</small>
          </div>
          <div class="form-field-user">
            <label>Your Address *</label>
            <input id="address" type="text" required>
            <small id="addressHelp">Auto-filled from your account (you can edit if needed)</small>
          </div>
          <div class="form-field-user full">
            <label>Purpose *</label>
            <input id="purpose" type="text" placeholder="e.g. Employment, Scholarship, Business Registration" required>
            <small>Please specify the reason for requesting this document</small>
          </div>
          <div class="form-field-user">
            <label>Payment Method</label>
            <select id="paymentMethod">
              <option value="">Select Payment Method (Optional)</option>
              <option>GCash</option>
              <option>GoTyme</option>
              <option>Local Bank</option>
              <option>Cash</option>
            </select>
            <small>Select your preferred payment method if payment is required</small>
          </div>
        </div>
        <input type="hidden" id="docId"/>
        <input type="hidden" id="selectedResidentId"/>
      </form>
    </div>
    <footer class="modal-footer-user">
      <button class="btn-secondary-user" id="cancelForm">Cancel</button>
      <button class="btn-primary-user" id="saveForm">Submit Request</button>
    </footer>
  </div>
</div>

<script defer src="/user/user-document-permits.js"></script>
</body>
</html>

